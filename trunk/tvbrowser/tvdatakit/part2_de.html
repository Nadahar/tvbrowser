<html>

	<head>
		<title>TV-Browser</title>
       <link rel="stylesheet" type="text/css" href="style.css">
	</head>
	<body>


<h1>PROGRAMMDATEN F&Uuml;R TV-BROWSER ANBIETEN</h1>
<h2>unter Verwendung der TV-Browser-Tools</h2>
<h1>Teil II</h1>


<p>
Das ist Teil II des TV-Daten-anbieten-Tutorials. Ich gehe davon aus, da&szlig; Teil I erfolgreich durchgearbeitet worden ist. Wir werden wieder die selben Tools verwenden.
</p>

<p>
W&auml;hrend wir im vorangegangenen Teil keine M&ouml;glichkeit hatten, eigene Programmdaten zu verwenden, werden wir nun das TV-Programm eines oder mehrerer Sender h&auml;ndisch erzeugen und wie in Teil I auf einen Webserver laden.
</p>
<p>
Wie in Teil I ist auch hier keine Programmierarbeit erforderlich.
</p>


<h3>Ein bi&szlig;chen Background: PrimaryDataServices</h3>

<p>
Im 1. Teil haben wir SimplePDS bereits kennengelernt.<br />
PrimaryDataServices (PDS) sind kleine Java-Programme, die TV-Daten
einsammeln.
Um TV-Daten automatisch einzusammeln, m&uuml;ssen PrimaryDataServices vom
Daten-Anbieter selber geschrieben (programmiert) werden.<br />
Neben dem SimplePDS, das wir in Teil I des Tutorials verwendet haben, liegt
dem Tutorial ein weiteres PDS bei: ExcelPDS (Autor des ExcelPDS ist Til Schneider).
</p>
<p>
Dieses PDS werden wir nun n&auml;her kennenlernen und konfigurieren.
</p>

<h3>ExcelPDS</h3>

<p>
Dazu &ouml;ffnen wir zun&auml;chst die Datei <em>TvData.xls</em> mit OpenOffice bzw. MS-Excel.<br />
Die Datei ist bereits mit ein paar Musterdaten gef&uuml;llt. Die Verwendung sollte also nicht schwer fallen.<br />

F&uuml;r jeden Sender brauchen wir zun&auml;chst eine eigene Tabelle. Unser Excel-File hat im Moment zwei solcher Tabellen (wir sind also f&uuml;r zwei Sender ger&uuml;stet).<br />
Je nachdem, ob wir beabsichtigen, mehr oder weniger Sender anzubieten, f&uuml;gen wir nun Tabellen hinzu oder l&ouml;schen die zweite Tabelle.<br />
Die fett-gedruckten Zellen m&uuml;ssen bei jeder Tabelle an der gleichen Position sein.
</p>
<p>
In die zweite Zeile jeder Sender-Tabelle f&uuml;gen wir nun Sender-ID des Senders ein:
</p>
<a name="channelTable"/>
<table border="1">
<tr>
  <th>Channel ID</th>
  <td>Unter diesem Namen behandelt TV-Browser den Sender. Einmal festgelegt, sollte man die ID nicht mehr &auml;ndern. &Auml;ndert man die ID, so entspricht das einem neuen Sender.<br />
      Als ID sind alphanumerische Zeichen erlaubt (d.h. Ziffern und Buchstaben, keine Sonderzeichen).<br />
      Innerhalb des TV-Browsers mu&szlig; die ID eindeutig sein (d.h. es darf es <em>keinen anderen Sender mit dieser ID geben</em>). Also bitte keine schon vorhandene ID benutzen.<br />
      <b>Hier mu&szlig; der selbe Name verwendet werden, wie in <em>gruppe_channellist.txt</em> im config-Verzeichnis.</b>
  </td>
</tr>
<tr>
  <th>Country Code</th>
  <td>Zweistelliger L&auml;ndercode nach <a href="http://www.chemie.fu-berlin.de/diverse/doc/ISO_3166.html">ISO 3166</a>. F&uuml;r Deutschland ist das z.B. <em>de</em>.</td>
</tr>
</table>

<p>
In der darunterliegenden Tabelle f&uuml;gen wir nun die Programmvorschau des Senders ein. Die Tabelle ist selbsterkl&auml;rend.<br />
Datum, Beginnzeit und Titel sind Pflichtfelder. Der Rest kann ausgef&uuml;llt werden, wenn die entsprechenden Informationen bekannt sind.
</p>
<p>
Wenn alles fertig ausgef&uuml;llt ist, speichern wir die Datei unter dem Namen "TvData.xls" im <em>workspace</em>-Verzeichnis ab.<br />
Damit k&ouml;nnen wir einen ersten Problelauf starten. Starten wir also den PDSRunner mit
</p>
<pre>
pdsrunner ExcelPDS
</pre>
<p>
Den PDSRunner kennen wir bereits. Diesmal f&uuml;hren wir ihn aber mit dem ExcelPDS aus.<br />
Sollten Fehler aufgetreten sein, so finden wir die Fehlermeldung im Verzeichnis <em>pdslog</em>.<br />
War PDSRunner erfolgreich, so haben wir wieder unsere Rohdaten im Verzeichnis <em>raw</em>.<br />
Nun fehlen noch die anderen beiden Tools: DataManager und MirrorUpdater. Diese m&uuml;ssen wir aber vorher noch konfigurieren.
</p>

<a name="configuration"/>
<h3>Konfiguration von DataManager und MirrorUpdater</h3>
<p>
Die Konfiguration der beiden Tools h&auml;ngt von der ID unserer Sendergruppe ab.<br />
</p>
<p>
Im <em>prepared</em>-Verzeichnis erzeugen wir insgesamt drei neue Dateien:
</p>
<ul>
<li>GRUPPENID.txt</li>
<li>GRUPPENID_mirrorlist.txt</li>
<li>GRUPPENID_channellist.txt</li>
</ul>

<p>Statt <em>GRUPPENID</em> ist nat&uuml;rlich die ID der Gruppe einzusetzen. Der Inhalt entspricht dem Inhalt der Dateien <em>myfirstgroup.txt</em> und <em>myfirstgroup_mirrorlist.txt</em> von <a href="part1_de.html">Teil I</a> und sollte inzwischen klar sein. <em>GRUPPENID_channellist.txt<em> brauchen wir fï¿½r den MirrorUpdater und wird in dem entsprechenden Abschnitt genauer besprochen.
</p>
<p>
Damit ist der DataManager konfiguriert. Starten wir ihn also:
</p>
<pre>
datamanager [GRUPPENID]
</pre>
<p>
Dem DataManager mu&szlig; - wie in Teil 1 - die Gruppen-ID &uuml;bergeben werden.<br />
Damit fehlt uns nur noch der MirrorUpdater. Die Konfigurationsdatei f&uuml;r den MirrorUpdater ist <em>MirrorUpdater.ini</em>. &Ouml;ffnen wir also diese Datei und passen wir die Zeile</p>
<pre>
  groups=GRUPPENID
</pre>
<p>an. Falls wir mehrere Gruppen-IDs verwenden m&ouml;chten, trennen wir sie mit einem <em>:</em> ab. Also z.B: </p>
<pre>groups=groupid1:groupid2:groupid3</pre>
<p>In der Regel sollte aber eine Gruppen-ID gen&uuml;gen.</p>

<p>
Erstellen wir nun die Datei <em>GRUPPENID_channellist.txt</em>, die Angaben zu den einzelnen Sendern enzh&auml;lt:
</p>
<p>
Der Aufbau der Senderliste ist ganz einfach: In jeder Zeile befinden sich die Angaben zu <em>einem</em> Sender.<br />
Aufbau einer Zeile:
</p>
<pre>land;zeitzone;senderID;sendername;copyright;sender-url;icon-url;senderkategorie</pre>
<p>
Land, Zeitzone, Sender-ID und Sendername sind unbedingt erforderlich. Die restlichen Angaben k&ouml;nnen auch weggelassen werden.
Eine Datei k&ouml;nnte z.B. so aussehen:
</p>
<pre>de;GMT+01:00;ard;ARD;(c) by DasErste/TV-Browser;http://www.ard.de;http://www.tvbrowser.org/icons/ard01.gif;3
de;GMT+01:00;rtl;RTL;;;;4
de;GMT+01:00;superrtl;SuperRTL
de;MET;zdf;ZDF;(c) by ZDF/TV-Browser
de;MET;vox;Vox;(c) by Vox;http://www.vox.de</pre>
<p>
Wichtig ist, da&szlig; alle Sender der Gruppe in dieser Datei vertreten sind.<br />
Die Angabe eines Icon-URL ist dabei optional. Fehlt diese, so stellt TV-Browser eben kein Icon zum Sender dar. (Der Strichpunkt mu&szlig; aber trotzdem gesetzt werden!)<br />
TV-Browser l&auml;dt das Icon jeweils nur 1x herunter. Erst wenn eine neue URL angegeben ist, wird TV-Browser veranla&szlig;t, das Icon neu zu laden. Sollte also ein Sender sein Logo &auml;ndern, so mu&szlig; in dieser Datei eine neue URL eingetragen werden. <strong>Das Icon mu&szlig; in einer Gr&ouml;&szlig;e von 40x20 Pixel vorliegen.</strong>
</p>
<p>
Der letzte Eintrag in der Zeile, <em>senderkategorie</em> bestimmt die Kategorie des Senders. Seit TV-Browser 2 k&ouml;nnen die Sender nach Kategorie gefiltert werden. Die Zahl f&uuml;r die Senderkategorie kann auf <a href="http://www.tvbrowser.org/pdsstarterkit/category.php">unserer Website</a> ermittelt werden.
</p>




<p>
F&uuml;hren wir nun den MirrorUpdater aus:
</p>
<pre>
  mirrorupdater MirrorUpdater.ini
</pre>
<p>
Geschafft! Die Daten sind nun auf dem Webserver. Wir k&ouml;nnen also die neue Gruppe in TV-Browser einf&uuml;gen. Die URL h&auml;ngt nat&uuml;rlich wieder von der Gruppen-ID ab:<br />
http://meinwebspace/tv-daten-test/GRUPPENID
</p>

<p class="note">
Fragen? Hat's doch nicht geklappt? Bei Problemen helfe ich gerne im <a href="http://hilfe.tvbrowser.org">Forum</a> weiter.
</p>

<h3>Regelm&auml;&szlig;e Aktualisierung</h3>
<p>
Die Daten auf dem Server m&uuml;ssen nun regelm&auml;&szlig;ig aktualisiert werden. Dazu m&uuml;ssen wir die obigen Tools bei jeder Aktualisierung ausf&uuml;hren:
</p>

<pre>pdsrunner ExcelPDS
datamanager [GRUPPENID]
mirrorupdater mirrorupdater.ini
</pre>
<p>
Vorher m&uuml;ssen die Daten nat&uuml;rlich wieder im Excel-File bearbeitet werden.
</p>
<p class="note">
<strong>Wichtig:</strong> Damit verhindert wird, da&szlig; TV-Browser auf Server zugreift, deren TV-Daten veraltet sind, wird auf jedem Server eine Datei mit dem Namen <em>lastupdate</em> gespeichert (dies &uuml;bernimmt der MirrorUpdater f&uuml;r uns).<br />
TV-Browser l&auml;dt keine Daten von Servern, die l&auml;nger als 5 Tage keine neuen Daten erhalten haben. Ein Daten-Anbieter mu&szlig; also mindestens alle 5 Tage aktualisieren.
</p>

<p>Der DataManager ben&ouml;tigt die Dateien im <em>prepared</em>-Verzeichnis, um daraus die Programm&auml;nderungen zu erstellen. Daher d&uuml;rfen die Dateien im <em>prepared</em>-Verzeichnis niemals gel&ouml;scht werden.<br />
L&ouml;scht man Dateien aus dem <em>prepared</em>-Verzeichnis, so stimmen die Daten nicht mehr mit denen zusammen, die der Benutzer bereits heruntergeladen hat. Folglich l&auml;dt TV-Browser keine Programm&auml;nderungen mehr f&uuml;r den entsprechenden Tag und Sender.
</p>



<p>
<table width="100%">
<tr>
<td align="left"><a href="part1_de.html">Zur&uuml;ck zu Teil I</a></td>
<td align="center"><a href="index_de.html">&Uuml;bersicht</a></td>
<td align="right"><a href="part3_de.html">Weiter zu Teil III</a></td>
</tr>
</table>

</p>

	</body>
</html>
