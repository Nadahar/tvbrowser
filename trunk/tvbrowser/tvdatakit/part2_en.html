<html>

	<head>
		<title>TV-Browser</title>
       <link rel="stylesheet" type="text/css" href="style.css">
	</head>
	<body>


<h1>PROVIDING TV LISTINGS FOR TV-BROWSER</h1>
<h2>using the TV-Browser tools</h2>
<h1>Part II</h1>


<p>
This is part II of the tutorial on providing tv listings. I will assume that you have successfully completed part I. We shall use the same tools for this part.
</p>

<p>
While we did not use custom tv listings during part I, we will now manually create listings for one or more channels and upload them to a web server like we did in part I.
</p>
<p>
You do not need to know how to write computer programs to complete this part.
</p>


<h3>Some background information: PrimaryDataServices</h3>

<p>
In part I, we already worked with SimplePDS.<br />
In general, PrimaryDataServices (PDS) are small Java applications that collect tv listings.
PrimaryDataServices must be written (programmed) by the listings providers themselves in order to be able to automatically collect the listings.
Besides SimplePDS, which we used during part I, this tutorial comes with another PDS: ExcelODS (developed by Til Schneider).
</p>
<p>
We will now learn more about this PDS and configure it to suit or needs.
</p>

<h3>ExcelPDS</h3>

<p>
First of all, we open the file <em>TvData.xls</em> in OpenOffice or MS Excel.<br />
The file already contains sample listings, so it will not be difficult to use.<br />

We need one table for each channel. The Excel file contains two tables, allowing us to provide listings for two channels.<br />
Depending on the number of channels we want to provide, we have to add new tables or delete one of the existing tables.<br />
The rows that use bold fonts must be in the same position for each table.
</p>
<p>
We enter the channel ID into the second row of the channel's table:
</p>
<a name="channelTable"/>
<table border="1">
<tr>
  <th>Channel ID</th>
  <td>This name is used by TV-Browser to identify the channel. Once assigned, it should not be changed. Otherwise, TV-Browser would not recognize the channel and assume that it was newly generated.<br />
      The ID consists of alphanumeric characters (i.e. letters and numbers, but no special characters).<br />
      TV-Browser must be able to identify each channel by a unique name; this means that new channels <em>must not use a channel ID that is already assigned to another channel</em>. So please make sure not to re-use existing channel IDs.<br />
      <b>The channel IDs in the Excel file must match those in <em>gruppe_channellist.txt</em> in the <em>config</em> directory.</b>
  </td>
</tr>
<tr>
  <th>Country code</th>
  <td>The country code identifies the country of origin for the channel. The format is specified in <a href="http://www.chemie.fu-berlin.de/diverse/doc/ISO_3166.html">ISO 3166</a>. Germany, for example, has a country code of <em>de</em>.</td>
</tr>
</table>

<p>
In the table below the one containing channel ID and country code, we enter the listings for the channel. The format is very simple.<br />
Date, start time and title of the program are mandatory fields, the rest can be filled in if enough information is available for the channel.
</p>
<p>
As soon as everything has been filled in, we save the file as <em>TVData.xls</em> in the <em>workspace</em> directory.<br />
Now we can start a first test run. We start PDSRunner with the command
</p>
<pre>
pdsrunner ExcelPDS
</pre>
<p>
We already know PDSRunner from part I. This time, we run it using ExcelPDS.<br />
If any errors occurred, the error messages can be found in the <em>pdslog</em> directory.<br />
If PDSRunner completed successfully, the raw listings can be found in the <em>raw</em> directory as usual.<br />
Now we need the two other tools: DataManager and MirrorUpdater. Before running them, however, we must configure them.
</p>

<a name="configuration"/>
<h3>Configuring DataManager and MirrorUpdater</h3>
<p>
When configuring the two tools, we need to take into account the name of our channel group.
</p>
<p>
In all, we will create three new files in the <em>prepared</em> folder:
</p>
<ul>
<li>GROUPID.txt</li>
<li>GROUPID_mirrorlist.txt</li>
<li>GROUPID_channellist.txt</li>
</ul>

<p>You have to replace <em>GROUPID</em>with the name you chose for your channel group. The contents of the first two files are equivalent to those of <em>myfirstgroup.txt</em> and <em>myfirstgroup_mirrorlist.txt</em> (see <a href="part1_en.html">part I</a>). <em>GROUPID_channellist.txt</em> will be needed for the MirrorUpdater; it will be described in detail below.
</p>
<p>
Now the configuration of the DataManager is complete, so let's run it:
</p>
<pre>
datamanager [GROUPID]
</pre>
<p>
The DataManager expects - as explained in part I - to receive the channel group name as its argument.<br />
The only step that is still missing is running the MirrorUpdater. The configuration file for the MirrorUpdater is named <em>MirrorUpdater.ini</em>. We open this file and edit the line</p>
<pre>
  groups=GROUPID
</pre>
<p>If you want to use several channel groups, separate them using <em>:</em>. For example, you might enter: </p>
<pre>groups=groupid1:groupid2:groupid3</pre>
<p>In most cases, one channel group will be sufficient.</p>

<p>
Now we will create the file <em>GROUPID_channellist.txt</em>, which contains information about the channels:
</p>
<p>
The channel list follows a simple format: Each line contains information about a single channel.<br />
The format of such a line is:
</p>
<pre>country;timezone;channel ID;channel name;copyright;channel url;icon url;channel category</pre>
<p>
Country, timezone, channel ID and channel name are mandatory. All other fields may be omitted.
A sample file might look like this:
</p>
<pre>de;GMT+01:00;ard;ARD;(c) by DasErste/TV-Browser;http://www.ard.de;http://www.tvbrowser.org/icons/ard01.gif;3
de;GMT+01:00;rtl;RTL;;;;4
de;GMT+01:00;superrtl;SuperRTL
de;MET;zdf;ZDF;(c) by ZDF/TV-Browser
de;MET;vox;Vox;(c) by Vox;http://www.vox.de</pre>
<p>
It is important to create a line for each channel belonging to the channel group.<br />
It is optional to add an URL pointing to the channel icon. If it is omitted, TV-Browser will not display an icon for that channel (however, the semicolon must be present even if no URL was entered).<br />
TV-Browser will download the icon only once; if the URL was changed, TV-Browser will re-load the icon. This means that you must enter a new URL when a new icon for a channel is available. <strong>The icon must have the dimensions of 40x20 pixels.</strong>
</p>
<p>
The last entry within a line, <em>channel category</em>, defines the categories that a channel belongs to. TV-Browser 2 and newer allows to filter channels by category. The number representing the categories can be computed with <a href="http://www.tvbrowser.org/pdsstarterkit/category.php">a script on our website</a>.
</p>

<p>
We are now ready to run MirrorUpdater:
</p>
<pre>
  mirrorupdater MirrorUpdater.ini
</pre>
<p>
Done! The listings have been uploaded to the webserver. Now we can add the new channel group to TV-Browser. The URL depends on the channel group name:<br />
http://mywebspace/tv-listings-test/GROUPID
</p>

<p class="note">
Any questions? Something didn't work as it should have? Just ask in <a href="http://forum.tvbrowser.org">our forum</a> and I will gladly help.
</p>

<h3>Updating the tv listings in regular intervals</h3>
<p>
The listings on the webserver must be updated regularly. For each update, the tools mentioned above have to be run:
</p>

<pre>pdsrunner ExcelPDS
datamanager [GROUPID]
mirrorupdater mirrorupdater.ini
</pre>
<p>
First of all, the updated listings must be entered into the Excel file, of course.
</p>
<p class="note">
<strong>Important note:</strong> To avoid that TV-Browser loads listings from servers that contain outdated listings, the MirrorUpdater stores a file named <em>lastupdate</em> on each server.<br />
TV-Browser will not use servers that have not been updated for more than five days. Hence, a listings provider has to update his servers at least every five days.
</p>

<p>DataManager requires the files in the <em>prepared</em> folder to determine the changes that were made to the listings. For this reason, you must not remove files from the <em>prepared</em> folder.<br />
If files were removed from the <em>prepared</em> folder, the listings would no longer be the same as those that the user has already downloaded. As a consequence, TV-Browser would not realize that the listings for that day and channel have changed and would never download the new listings.
</p>



<p>
<table width="100%">
<tr>
<td align="left"><a href="part1_en.html">Back to part I</a></td>
<td align="center"><a href="index_en.html">Overview</a></td>
<td align="right"><a href="part3_en.html">On to part III</a></td>
</tr>
</table>

</p>

	</body>
</html>
